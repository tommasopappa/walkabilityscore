# Walkability Explorer with Optimal Routing

A Streamlit-based web application for exploring walkability scores across Massachusetts road networks and finding optimal walking routes based on various user profiles.

## Features

- ğŸ“Š **Comprehensive Analysis**: View walkability scores for 96,000+ road segments across Massachusetts
- ğŸ™ï¸ **City-Level Statistics**: Compare average walkability scores across different cities
- ğŸ—ºï¸ **Interactive Visualizations**: Map visualizations with clustering for performance
- ğŸ§­ **Route Finder**: Find the most walkable routes between two points
- ğŸ‘¥ **Multiple User Profiles**: Analyze walkability for different user types:
  - Standard pedestrians
  - Seniors
  - Children
  - Mobility impaired individuals
  - Athletes
- ğŸ“ˆ **Data Analysis**: Score distributions, percentile analysis, and city comparisons
- ğŸ’¾ **Data Export**: Export analysis results in various formats

## Prerequisites

- Python 3.8 or higher
- 8GB RAM minimum (16GB recommended for full dataset processing)
- 5GB free disk space

## Installation

### Windows Users

1. **Install Python** (if not already installed):
   - Download Python from [python.org](https://www.python.org/downloads/)
   - During installation, **CHECK** "Add Python to PATH"
   - Verify installation by opening Command Prompt and typing:
     ```cmd
     python --version
     ```

2. **Clone or download this repository**:
   - Option A: If you have Git installed:
     ```cmd
     git clone <repository-url>
     cd walkability_widget
     ```
   - Option B: Download as ZIP and extract to your desired location

3. **Create a virtual environment** (recommended):
   ```cmd
   python -m venv venv
   venv\Scripts\activate
   ```

4. **Install required packages**:
   ```cmd
   pip install -r requirements.txt
   ```

### macOS/Linux Users

1. **Clone the repository**:
   ```bash
   git clone <repository-url>
   cd walkability_widget
   ```

2. **Create a virtual environment**:
   ```bash
   python3 -m venv venv
   source venv/bin/activate
   ```

3. **Install requirements**:
   ```bash
   pip install -r requirements.txt
   ```

## Data Setup

### Required Data Files

The application requires the following data files:

1. **GeoJSON Road Network Data**: 
   - File: `MassDOTRoads_gdb_1226590767708312459.geojson`
   - This should be placed in the parent directory of the widget
   - Contains Massachusetts road network data from MassDOT

2. **Analysis Results** (generated by analysis script):
   - Directory: `walkability_results_full/`
   - Files:
     - `analysis_summary.json`
     - `scores_standard.csv`
     - `scores_seniors.csv`
     - `scores_children.csv`
     - `scores_mobility_impaired.csv`
     - `scores_athletes.csv`

### File Structure

Ensure your directory structure looks like this:
```
your_project_folder/
â”‚
â”œâ”€â”€ walkability_widget/
â”‚   â”œâ”€â”€ app_with_routing.py
â”‚   â”œâ”€â”€ requirements.txt
â”‚   â”œâ”€â”€ README.md
â”‚   â””â”€â”€ debug/
â”‚
â”œâ”€â”€ MassDOTRoads_gdb_1226590767708312459.geojson
â”‚
â””â”€â”€ walkability_results_full/
    â”œâ”€â”€ analysis_summary.json
    â””â”€â”€ scores_*.csv files
```

### Windows Path Configuration

For Windows users, you may need to update the file paths in `app_with_routing.py`:

1. Open `app_with_routing.py` in a text editor
2. Find and replace the Unix-style paths with Windows paths:
   ```python
   # Change from:
   geojson_path = "/Users/tommaso/prototypescorings/MassDOTRoads_gdb_1226590767708312459.geojson"
   
   # To (example):
   geojson_path = r"C:\Users\YourUsername\walkability_project\MassDOTRoads_gdb_1226590767708312459.geojson"
   ```
3. Update all paths that reference:
   - `MassDOTRoads_gdb_1226590767708312459.geojson`
   - `walkability_results_full/`

## Running the Application

### Windows
```cmd
# Activate virtual environment (if created)
venv\Scripts\activate

# Run the application
streamlit run app_with_routing.py
```

### macOS/Linux
```bash
# Activate virtual environment (if created)
source venv/bin/activate

# Run the application
streamlit run app_with_routing.py
```

The application will open in your default web browser at `http://localhost:8501`

## Using the Application

### 1. Overview Tab
- View overall statistics for the selected user class
- See score distributions across different categories
- Compare metrics across different user types

### 2. City Analysis Tab
- Explore walkability scores by city
- Filter cities by minimum number of roads
- Export city statistics as CSV

### 3. Map Visualization Tab
- View road segments on an interactive map
- Color-coded by walkability score
- Filter by city and adjust sample size for performance

### 4. Route Finder Tab
If the interactive map doesn't display, use the alternative methods:
- **Popular Locations**: Select from pre-defined locations
- **Manual Coordinates**: Enter exact latitude/longitude
- **City Search**: Choose start and end cities

Steps to find a route:
1. Select your start and end points using any method
2. Click "Find Optimal Route"
3. View the route with color-coded segments based on walkability
4. Check route statistics and segment details

### 5. Score Distribution Tab
- Analyze score distributions with histograms
- View box plots by city
- Explore score percentiles

### 6. Data Export Tab
- Export summary statistics
- Generate custom data exports
- Download analysis results

## Troubleshooting

### Common Issues

1. **"No analysis results found!" error**
   - Ensure the `walkability_results_full/` directory exists with all required files
   - Run the analysis script first if needed

2. **Map not displaying in Route Finder**
   - This is a known issue with some Streamlit-Folium configurations
   - Use the alternative input methods provided (dropdowns, manual entry)

3. **Memory errors with large datasets**
   - Reduce the sample size in Map Visualization
   - Close other applications to free up memory
   - Consider upgrading RAM if working with full dataset frequently

4. **Path errors on Windows**
   - Ensure all paths use proper Windows format (backslashes or raw strings)
   - Check that all required files are in the correct locations

### Performance Tips

- Start with smaller sample sizes (1,000-5,000 roads) for map visualization
- The route finder works best with points within 10-15 miles of each other
- City analysis is pre-aggregated and should be fast regardless of dataset size

## Technical Details

### Scoring Methodology

The walkability scoring system evaluates roads based on:
- Sidewalk presence and width
- Traffic volume (AADT)
- Speed limits
- Road classification
- Terrain type
- Shoulder width
- Additional safety features

Scores are adjusted for different user profiles:
- **Seniors**: Higher weight on safety features, lower traffic tolerance
- **Children**: Maximum safety requirements, school zone considerations
- **Mobility Impaired**: Emphasis on sidewalk quality and curb cuts
- **Athletes**: Preference for continuous routes, less traffic sensitivity

### Route Finding Algorithm

The route finder uses:
- Network graph construction from road segments
- Weighted shortest path algorithm (Dijkstra's)
- Weights inversely proportional to walkability scores
- Dynamic area loading based on start/end points

## Requirements File

Create a `requirements.txt` file with:
```
streamlit>=1.28.0
pandas>=1.5.0
numpy>=1.24.0
folium>=0.14.0
streamlit-folium>=0.15.0
plotly>=5.17.0
networkx>=3.1
```

## Contributing

Feel free to submit issues, fork the repository, and create pull requests for any improvements.

## License

This project is licensed under the MIT License - see the LICENSE file for details.

## Acknowledgments

- MassDOT for providing the road network data
- Anthropic for AI assistance in development
- Streamlit team for the excellent web framework
